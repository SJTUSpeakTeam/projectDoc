# 临时文档

````
Create Date: 2020/10/19
Last Update: 2020/11/15
````
×表示未完成 

√表示完成

相关变量名见 UML oom 文件

所有请求请封装到 api.js 中

返回值，swagger文档，请求地址于 2020/10/20 更新

# 零、图片/文件上传

**上传图片/文件**

````
Auth: None
Request: POST /file/upload
body: {
	RawBlobData // 将 raw blob 数据直接上传，不要打包 JSON
}

Response:
data(successful): {
    "status": Integer // -1 为失败， 0 为成功
    "msg": String // 例子："操作成功 : )",
    "data": {
    	"link" : String // 即 图片/文件 的获取链接
    }
}

````



# 一、用户管理

**用户状态须知：**

````
用户状态：user_type or userType
内容：Integer
分类：
0: 被 ban 用户
1: 管理员用户
2: 正常用户
````

**登录**

````
Auth: None
Request: POST /login
Body: {
    "mailAddr": String,
    "password": String
}

Response:
data(successful): {
    "status": Integer, // -1 为失败， 0 为成功
    "msg": String, // 例子："登录成功 :)"
    "data": {
        "avatar": String,  // 这是个 url
        "createTime": Datetime ,
        "gender": Boolean ,
        "mailAddr": String,
        "nickname": String,
        "phoneNum": String,
        "userId": Integer,
        "token": String,
        "email": String,
        "user_type": Integer // 用来判断跳转去用户还是管理员界面
    }
}
````

**检查用户名存在**

````
Auth: None
Request: GET /verify/nickname
Parameters: value(String)

Response:
data(successful): {
    "status": Integer // -1 为失败， 0 为成功
    "msg": String // 例子："操作成功 : )",
}
````

**检查邮箱存在**

````
Auth: None
Request: GET /verify/mailAddr
Parameters: value(String)

Response:
data(successful): {
    "status": Integer // -1 为失败， 0 为成功
    "msg": String // 例子："操作成功 : )",
}
````

**注册**

````
Auth: None
Request: POST /registry
Body: {
    "mailAddr": String,
    "phoneNum": String,
    "password": String,
    "nickname": String
}

Response:
data(successful): {
    "status": Integer // -1 为失败， 0 为成功
    "msg": String // 例子："操作成功 : )",
}
````

**ban 一堆用户 **

````
Auth: Admin
Request: POST /user/ban
Body: {
    "idArray": [Integer, Integer, ... , Integer]
}

Response:
data(successful): {
    "status": Integer // -1 为失败， 0 为成功
    "msg": String // 例子："用户的 id 不存在:0",
}
````

**解 ban 一堆用户**

````
Auth: Admin
Request: POST /user/lift-ban
Body: {
    "idArray": [Integer, Integer, ... , Integer]
}

Response:
data(successful): {
    "status": Integer // -1 为失败， 0 为成功
    "msg": String // 例子："用户的 id 不存在:0",
}
````

**取得单个用户信息**

````
Auth: User
Request: GET /user/get-one
Parameters: id(Integer)

Response:
data(successful): {
                "user": {
                    "avatar": "未知",
                    "createTime": DateTime,
                    "gender": true,
                    "nickname": "KONY",
                    "phoneNum": "17317790037",
                    "userId": 3
                },
                "userAuth": {
                    "mailAddr": "lhy159840@sjtu.edu.cn",
                    "userType": 2,
                    "humanStatus": "正常用户" // 用人能看懂的语言描述用户状态
                },
                "regularUser": {   // 普通用户返回该值，管理员用户返回 adminUser
                    "answerNum": 0,
                    "commentNum": 0,
                    "fansNum": 0,
                    "followNum": 0,
                    "liftingTime": DateTime,
                    "profile": "这个用户很懒，还没有描述过自己~",
                    "questionNum": 0,
                    "status": 2,
                    "visitNum": 0
                },
                "adminUser": { // 管理员返回该值，普通用户返回 regularUser
                    "contentBanNum": 0,
                    "senWordNum": 0,
                    "userBanNum": 0,
                }
}
````

**取得所有用户信息（每页 8 个）**

````
Auth: Admin
Request: GET /user/get-all
Parameters: page(Integer) // 页码参数从 0 开始

Response:
data(successful): {
    "status": 0,
    "msg": "操作成功 :)",
    "data": {
        "userList": [
            {
                "user": {
                    "avatar": "未知",
                    "createTime": DateTime,
                    "gender": true,
                    "nickname": "KONY",
                    "phoneNum": "17317790037",
                    "userId": 3
                },
                "userAuth": {
                    "mailAddr": "lhy159840@sjtu.edu.cn",
                    "userType": 2,
                    "humanStatus": "正常用户" // 用人能看懂的语言描述用户状态
                },
                "regularUser": {   // 普通用户返回该值，管理员用户返回 adminUser
                    "answerNum": 0,
                    "commentNum": 0,
                    "fansNum": 0,
                    "followNum": 0,
                    "liftingTime": DateTime,
                    "profile": "这个用户很懒，还没有描述过自己~",
                    "questionNum": 0,
                    "status": 2,
                    "visitNum": 0
                }
            },
            {
                "user": {
                    "avatar": "未知",
                    "createTime": DateTime,
                    "gender": true,
                    "nickname": "KONY",
                    "phoneNum": "15685030037",
                    "userId": 4
                },
                "userAuth": {
                    "mailAddr": "lhy15981@sjtu.edu.cn",
                    "userType": 2,
                    "humanStatus": "正常用户"
                },
                "adminUser": { // 管理员返回该值，普通用户返回 regularUser
                    "contentBanNum": 0,
                    "senWordNum": 0,
                    "userBanNum": 0,
                }
            },
            ...
        ],
        
        "page": 0 // 说明你当前的页码是第几页
    }
}
````

**// 个人主页**

（非主要）

获取 json：

头像

来临时间

姓名

性别二

手机号

邮箱地址

个人简介

统计信息（关注、粉丝、提问、回答、评论、主页浏览次数）

**// 修改个人信息**

（非主要）

上传 json：

头像

来临时间

姓名

性别二

手机号

邮箱地址

个人简介

统计信息（关注、粉丝、提问、回答、评论、主页浏览次数）

# 二、问题管理 (likeNum和favorNum选择likeNum)
* #### 问题发布 √
```matlab
Request: POST /postQuestion
Body: {
    *header: string
    *content: string
    *userId: integer
    *theme: string
    tags: [string, ...]
}

Response:
data(successful): {
    questionId: integer
}
```

* #### 问题用户获取 √ (10个)
```matlab
Request: GET /getUserQuestions
Parameters: beginQuestionId(integer) userId(integer)

Response:
data(successful): {
    [
        questionId: integer
        userId: integer
        theme: string
        header: string
        content: string
        createTime: date
        likeNum: integer
        favorNum: integer
        visitNum: integer
        status: short
        tags: [string, ...]
    ]
}
```

* #### 问题最新获取 √ (5个)(根据date)
```matlab
Request: GET /getNewQuestions

Response:
data(successful): {
    [
        questionId: integer
        userId: integer
        theme: string
        header: string
        content: string
        createTime: date
        likeNum: integer
        favorNum: integer
        visitNum: integer
        status: short
        tags: [string, ...]
    ]
}
```

* #### 问题热门获取 √ (5个)(根据viewNum)
```matlab
Request: GET /getHotQuestions

Response:
data(successful): {
    [
        questionId: integer
        userId: integer
        theme: string
        header: string
        content: string
        createTime: date
        likeNum: integer
        favorNum: integer
        visitNum: integer
        status: short
        tags: [string, ...]
    ]
}
```

* #### 问题筛选获取 √ (10个)
```matlab
Request: POST /getFilterQuestions
BODY:{
    *beginQuestionId: integer
    search:string
    theme:string
    mostLike:boolean
    hottest:boolean
    mostReply:boolean
    newest:boolean
}

Response:
data(successful): {
    [
        questionId: integer
        userId: integer
        theme: string
        header: string
        content: string
        createTime: date
        likeNum: integer
        favorNum: integer
        visitNum: integer
        status: short
        tags: [string, ...]
    ]
}
```

* #### 问题获取 √
```matlab
Request: GET /getQuestion
Parameters: questionId(integer)

Response:
data(successful): {
    questionId: integer
    userId: integer
    theme: string
    header: string
    content: string
    createTime: date
    likeNum: integer
    favorNum: integer
    visitNum: integer
    tags: [string, ...]
}
```

* #### 问题更改 √
```matlab
Request: POST /updateQuestion
Body: {
    *questionId: integer
    *theme: string
    *userId: integer
    header: string
    content: string
    tags: [string, ...]
}

Response:
data(successful): {
    questionId: integer
}
```

* #### 问题封禁 √
```matlab
Request: PUT /banQuestion
Body: {
    *questionId: integer
}

Response:
data(successful): {}
```

* #### 问题删除 √
```matlab
Request: DELETE /deleteQuestion
Body: {
    *questionId: integer
    *userId: integer
}

Response:
data(successful): {}
```

* #### 问题点赞 √
```matlab
Request: GET /likeQuestion
Parameters: userId(integer),questionId(integer),like(boolean)

```

* #### 问题收藏 √
```matlab
Request: GET /collectQuestion
Parameters: userId(integer),questionId(integer),collect(boolean)

```

* #### 增加问题访问次数 × (需要使用user类)
```matlab
Request: GET /browseQuestion
Parameters: userId(integer),questionId(integer)
```

# 三、回答管理
* #### 回答发布 √
```matlab
Request: POST /postAnswer
Body: {
    *questionId: integer
    *userId: integer
    *content: string
}

Response:
data(successful): {
    answerId: integer
}
```

* #### 回答用户获取 √ (10条)

```matlab
Request: GET /getUserAnswers (-1为从最新的开始)
Parameters: beginAnswerId(integer) userId(integer)

Response:
data(successful): {
    [
        answerId: integer
        questionId: integer
        userId: integer
        content: string
        createTime: date
        likeNum: integer
        favorNum: integer
        visitNum: integer
    ]
}
```

* #### 根据问题获取回答 √

```matlab
Request: GET /getAnswerByQuestion (-1为从最新的开始)
Parameters: beginAnswerId(integer) questionId(integer)

Response:
data(successful): {
    [
        answerId: integer
        questionId: integer
        userId: integer
        content: string
        createTime: date
        likeNum: integer
        favorNum: integer
        visitNum: integer
    ]
}
```

* #### 回答获取 √
```matlab
Request: GET /getAnswer
Parameters: answerId(integer)

Response:
data(successful): {
    answerId: integer
    questionId: integer
    userId: integer
    content: string
    createTime: date
    likeNum: integer
    favorNum: integer
    visitNum: integer
}
```

* #### 回答更改 √
```matlab
Request: POST /updateAnswer
Body: {
    *answerId: integer
    *userId: integer
    *content: string
}

Response:
data(successful): {
    answerId: integer
}
```

* #### 回答删除 √
```matlab
Request: DELETE /deleteAnswer
Body: {
    *answerId: integer
    *userId: integer
}

Response:
data(successful): {}
```

* #### 回答点赞 √
```matlab
Request: GET /likeAnswer
Parameters: userId(integer),answerId(integer),like(boolean)

```

* #### 回答收藏 √
```matlab
Request: GET /collectAnswer
Parameters: userId(integer),answerId(integer),collect(boolean)

```

* #### 增加回答访问次数 ×
```matlab
Request: GET /browseAnswer
Parameters: userId(integer),answerId(integer)
```

# 四、评论管理
* #### 评论发布 √
```matlab
Request: POST /postComment
Body: {
    *answerId: integer
    *userId: integer
    *content: string
    fatherCommentId: integer
}

Response:
data(successful): {
    commentId: integer
}
```


* #### 评论获取 √
```matlab
Request: GET /getComment
Parameters: commentId(integer) 

Response:
data(successful): {
    commentId: integer
    answerId: integer
    userId: integer
    commentContent: string
    createTime: date
    likeNum: integer
    commentedNum: integer
}
```

* #### 根据回复获取评论 √

```matlab
Request: GET /getCommentByAnswer (-1为从最新的开始)
Parameters: beginCommentId(integer) answerId(integer)

Response:
data(successful): {
    [
        commentId: integer
        answerId: integer
        userId: integer
        commentContent: string
        createTime: date
        likeNum: integer
        commentedNum: integer
    ]
}
```

* #### 评论不可更改 

* #### 评论删除 √
```matlab
Request: DELETE /deleteComment
Body: {
    *commentId: integer
    *userId: integer
}

Response:
data(successful): {}
```

* #### 评论点赞 √
```matlab
Request: GET /likeComment
Parameters: userId(integer),commentId(integer),like(boolean)

```

# 五、标签管理

* #### 标签创建 √
```matlab
Request: POST /postTag
Body: {
    *content: string
}

Response:
data(successful): {
    content: string
}
```

* #### 标签获取(获取所有标签) √
```matlab
Request: GET /getTags

Response:
data(successful): {
    tags:[string,...]
}
```

* #### 标签更改 √
```matlab
Request: POST /updateTag
Body: {
    *content: string
    *newContent: string
}

Response:
data(successful): {
    content: string
}
```

* #### 标签删除 √
```matlab
Request: DELETE /deleteTag
Body: {
    *content: string
}

Response:
data(successful): {}
```

* #### 多个标签删除 √
```matlab
Request: DELETE /deleteTags
Body: {
    *content: [string,...]
}

Response:
data(successful): {}
```

# 六、主题管理

* #### 主题创建 √
```matlab
Request: POST /postTheme
Body: {
    *name: string
}

Response:
data(successful): {
    themeId: integer
}
```

* #### 主题获取(获取所有主题) √
```matlab
Request: GET /getThemes

Response:
data(successful): {
    themes: [
        {
            themeId: Integer,
            name: string,
            createTime: date,
        }
    ]
}
```

* #### 主题获取 √
```matlab
Request: GET /getTheme
Parameters: themeId(integer)

Response:
data(successful): {
    themeId: integer
    name: string
    createTime: date
}
```

* #### 主题更改 √
```matlab
Request: POST /updateTheme
Body: {
    *themeId: integer
    *name: string
}

Response:
data(successful): {
    themeId: integer
}
```

* #### 主题删除 √
```matlab
Request: DELETE /deleteTheme
Body: {
    *themeId: integer
}

Response:
data(successful): {}
```

* #### 多个主题删除 √
```matlab
Request: DELETE /deleteThemes
Body: {
    *themeId: [integer,...]
}

Response:
data(successful): {}
```

# 七、专家管理

* #### 徽章创建 ×
```matlab
Request: POST /postExpertBadge
Body: {
    *professionId: string
    *badgeImg: string
    *badgeInf: string
}

Response:
data(successful): {
    badgeId: integer
}
```

* #### 徽章获取 ×
```matlab
Request: GET /getExpertBadge
Parameters: badgeId(integer)

Response:
data(successful): {
    badgeId: integer
    profession: string
    grantDate: date
    badgeImg: string
    badgeInf string
}
```

* #### 徽章更改(不是很明确是否应该允许更改徽章) ×
```matlab
Request: POST /updateExpertBadge
Body: {
    *badgeId: integer
    profession: string
    badgeImg: string
    badgeInf string
}

Response:
data(successful): {
    badgeId: string
}
```

* #### 徽章删除 ×
```matlab
Request: DELETE /deleteExpertBadge
Body: {
    *badgeId: integer
}

Response:
data(successful): {}
```

* #### 徽章授予 ×
```matlab
Request: POST /grantExpertBadge
Body: {
    *badgeId: integer
    *uuserId: integer
}

Response:
data(successful): {}
```

# 八、举报系统

* #### 举报创建(针对某一用户) ×
```matlab
Request: POST /postTipOff
Body: {
    *userId: string
    *content: string
    *conversation: string
}

Response:
data(successful): {
    tipOffId: integer
}
```

//举报问题(跟龙哥商量)

* #### 举报获取 ×
```matlab
Request: GET /getTipOffs
Parameters: userId(integer)

Response:
data(successful): {
    tipOffId: [integer,...]
    createTime: [date,...]
    content: [string,...]
    conversation: [string,...]
}
```

* #### 举报删除 ×
```matlab
Request: DELETE /deleteTipOff
Body: {
    *userId: integer
    *tipOffId: integer
}

Response:
data(successful): {}
```